"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ElementFilter = void 0;
const AncestorFilter_1 = require("./AncestorFilter");
const DescendantFilter_1 = require("./DescendantFilter");
const SiblingFilter_1 = require("./SiblingFilter");
const PropertiesFilter_1 = require("./PropertiesFilter");
const ChildFilter_1 = require("./ChildFilter");
const ParentFilter_1 = require("./ParentFilter");
const PrevSiblingFilter_1 = require("./PrevSiblingFilter");
const NextSiblingFilter_1 = require("./NextSiblingFilter");
const BaseFilter_1 = require("./BaseFilter");
const FilterFactory_1 = require("../utils/FilterFactory");
class ElementFilter extends BaseFilter_1.BaseFilter {
    doFiltering(controls) {
        this.checkElementProperties();
        let filteredControls = this.filterFactory.getInstance(PropertiesFilter_1.PropertiesFilter, this.elementProperties).filter(controls);
        filteredControls = this.filterFactory.getInstance(AncestorFilter_1.AncestorFilter, this.elementProperties?.ancestorProperties).filter(filteredControls);
        filteredControls = this.filterFactory.getInstance(DescendantFilter_1.DescendantFilter, this.elementProperties?.descendantProperties).filter(filteredControls);
        filteredControls = this.filterFactory.getInstance(SiblingFilter_1.SiblingFilter, this.elementProperties?.siblingProperties).filter(filteredControls);
        return filteredControls;
    }
    doCheckSingle(control) {
        this.checkElementProperties();
        let pass = this.filterFactory.getInstance(PropertiesFilter_1.PropertiesFilter, this.elementProperties).checkSingle(control);
        pass &&= this.filterFactory.getInstance(AncestorFilter_1.AncestorFilter, this.elementProperties?.ancestorProperties).checkSingle(control);
        pass &&= this.filterFactory.getInstance(DescendantFilter_1.DescendantFilter, this.elementProperties?.descendantProperties).checkSingle(control);
        pass &&= this.filterFactory.getInstance(SiblingFilter_1.SiblingFilter, this.elementProperties?.siblingProperties).checkSingle(control);
        return pass;
    }
    checkElementProperties() {
        if (this.elementProperties?.prevSiblingProperties || this.elementProperties?.nextSiblingProperties || this.elementProperties?.childProperties || this.elementProperties?.parentProperties) {
            console.error(`The selector your provided ${JSON.stringify(this.elementProperties)} contains childProperties, parentProperties, prevSiblingProperties or nextSiblingProperties, please provide a valid selector without these properties`);
            throw new Error("Nested properties can only be used for ancestorProperties, descendantProperties or siblingProperties.");
        }
    }
    static filterBySelector(ui5Selector, controls) {
        const filterFactory = new FilterFactory_1.FilterFactory();
        let validUi5Controls = filterFactory.getInstance(ElementFilter, ui5Selector.elementProperties).filter(controls);
        validUi5Controls = filterFactory.getInstance(ParentFilter_1.ParentFilter, ui5Selector.parentProperties).filter(validUi5Controls);
        validUi5Controls = filterFactory.getInstance(AncestorFilter_1.AncestorFilter, ui5Selector.ancestorProperties).filter(validUi5Controls);
        validUi5Controls = filterFactory.getInstance(ChildFilter_1.ChildFilter, ui5Selector.childProperties).filter(validUi5Controls);
        validUi5Controls = filterFactory.getInstance(DescendantFilter_1.DescendantFilter, ui5Selector.descendantProperties).filter(validUi5Controls);
        validUi5Controls = filterFactory.getInstance(SiblingFilter_1.SiblingFilter, ui5Selector.siblingProperties).filter(validUi5Controls);
        validUi5Controls = filterFactory.getInstance(PrevSiblingFilter_1.PrevSiblingFilter, ui5Selector.prevSiblingProperties).filter(validUi5Controls);
        validUi5Controls = filterFactory.getInstance(NextSiblingFilter_1.NextSiblingFilter, ui5Selector.nextSiblingProperties).filter(validUi5Controls);
        return validUi5Controls;
    }
}
exports.ElementFilter = ElementFilter;
//# sourceMappingURL=ElementFilter.js.map